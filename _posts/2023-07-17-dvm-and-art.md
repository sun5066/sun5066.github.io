---
layout: post
title: "Android ART(Android Runtime)에 대해서 알아보자 1편"
date: 2023-07-17 09:20:00 -0400 
categories: android
tags: android art
comments: 1
---

이 글은 안드로이드 공식 문서를 읽어보는 글입니다.

## ART 작동 방식

ART는 AOT(ahead-of-time) 컴파이을 사용하며 Android 7.0(Nougat)부터는 AOT, JIT(just-in-time) 컴파일, 프로필 기반 컴파일을 조합하여 사용한다.

이러한 모든 컴파일 모드의 조합은 구성가능 하며 공식 문서에서 확인 할 수 있다.
 
Android 7.0부터는 JIT + AOT 방식을 조합하여 사용하며, 처음 설치할 때 JIT 방식으로 빠르게 설치한 후 자주 사용되는 앱은 기기 미사용 상태나 충전 중일 때 컴파일 데몬이 실행되어 조금씩 컴파일 하여 AOT 방식으로 바꾸도록 한다.

두 방식에 대해서 간단히 말하면 다음과 같다.

JIT
- 앱 **실행** 시 **컴파일**
- 설치 시 컴파일을 하지 않기 때문에 AOT보다 **설치 속도 빠름**
- 실행 시 컴파일을 하기 때문에 AOT에 비해 **실행 속도 느림**
- **용량 작음**

AOT
- 앱 **설치** 시 **컴파일**
- 설치 시 컴파일을 완료하기 때문에 JIT에 비해 **설치 속도 느림**
- 실행 시 컴파일을 하지 않기 때문에 JIT에 비해 **실행 속도 빠름**
- **용량 큼**(JIT에서 실행 시 컴파일하는 것을 미리 컴파일 하여 가지고 있기 때문)

----

## DVM(Dalvik Virtual Machine)

당시 구글에서 안드로이드에 JVM이 아닌 DVM이 선택된 이유중 라이센스 문제 외에도 몇가지 이유가 있었다.

1. 메모리 관리: DVM은 JVM과는 다른 메모리 관리 방식을 사용한다. JVM은 스택 기반 메모리 할당을 사용하고, DVM은 레지스터 기반 메모리 할당을 사용하여 안드로이드 기기의 한정된 리소스를 효율적으로 활용할 수 있다.
2. 최적화: 안드로이드는 대부분의 기기에서 사용되는 모바일 플랫폼이기 때문에, 성능과 배터리 수명을 최적화하는 것이 중요했으며, 당시 DVM은 이러한 요구사항에 맞게 최적화 되어있었다.
3. DEX 바이트코드: DVM은 안드로이드 앱을 위해 바이트 코드로 변환 하는 과정을 거치는 DEX 파일 형식을 사용한다. 이는 앱의 용량을 더 작은 크기로 압축이 가능하다.
4. 범용성: 당시 안드로이드 기기들은 다양항 아키텍처와 하드웨어를 사용했으며, DVM은 크로스 플랫폼 호환성을 지원하여 다양한 기기에서 실행되도록 할 수 있었다.

------

샬라샬라 작성중